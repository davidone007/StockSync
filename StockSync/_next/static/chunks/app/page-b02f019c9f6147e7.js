(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7130:function(e,s,a){Promise.resolve().then(a.bind(a,8934))},8934:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ei}});var r=a(7437),t=a(2265),n=a(4508);function l(){try{let e=new(window.AudioContext||window.webkitAudioContext),s=e.createOscillator(),a=e.createGain();s.connect(a),a.connect(e.destination),s.frequency.value=800,s.type="sine",a.gain.setValueAtTime(.3,e.currentTime),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.1),s.start(e.currentTime),s.stop(e.currentTime+.1)}catch(e){console.error("Error al reproducir el beep:",e)}}var c=a(4438),i=a(2869),o=a(6070),d=a(5186);let m=(0,a(535).j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:s,variant:a,...t}=e;return(0,r.jsx)("div",{className:(0,n.cn)(m({variant:a}),s),...t})}var x=a(1312);let p=x.fC,h=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(x.aV,{ref:s,className:(0,n.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...t})});h.displayName=x.aV.displayName;let g=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(x.xz,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...t})});g.displayName=x.xz.displayName;let j=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(x.VY,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...t})});j.displayName=x.VY.displayName;var f=a(9027),v=a(2489);let N=f.fC;f.xz;let b=f.h_;f.x8;let y=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(f.aV,{ref:s,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t})});y.displayName=f.aV.displayName;let w=t.forwardRef((e,s)=>{let{className:a,children:t,...l}=e;return(0,r.jsxs)(b,{children:[(0,r.jsx)(y,{}),(0,r.jsxs)(f.VY,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[t,(0,r.jsxs)(f.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(v.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});w.displayName=f.VY.displayName;let C=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};C.displayName="DialogHeader";let k=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(f.Dx,{ref:s,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...t})});k.displayName=f.Dx.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(f.dk,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a),...t})}).displayName=f.dk.displayName;var S=a(6815);let D=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...t})});D.displayName="Textarea";var I=a(9068),z=a(875),A=a(2135),P=a(401);let Z=I.fC;I.ZA;let F=I.B4,E=t.forwardRef((e,s)=>{let{className:a,children:t,...l}=e;return(0,r.jsxs)(I.xz,{ref:s,className:(0,n.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[t,(0,r.jsx)(I.JO,{asChild:!0,children:(0,r.jsx)(z.Z,{className:"h-4 w-4 opacity-50"})})]})});E.displayName=I.xz.displayName;let O=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(I.u_,{ref:s,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,r.jsx)(A.Z,{className:"h-4 w-4"})})});O.displayName=I.u_.displayName;let U=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(I.$G,{ref:s,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,r.jsx)(z.Z,{className:"h-4 w-4"})})});U.displayName=I.$G.displayName;let _=t.forwardRef((e,s)=>{let{className:a,children:t,position:l="popper",...c}=e;return(0,r.jsx)(I.h_,{children:(0,r.jsxs)(I.VY,{ref:s,className:(0,n.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...c,children:[(0,r.jsx)(O,{}),(0,r.jsx)(I.l_,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,r.jsx)(U,{})]})})});_.displayName=I.VY.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(I.__,{ref:s,className:(0,n.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...t})}).displayName=I.__.displayName;let R=t.forwardRef((e,s)=>{let{className:a,children:t,...l}=e;return(0,r.jsxs)(I.ck,{ref:s,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(I.wU,{children:(0,r.jsx)(P.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(I.eT,{children:t})]})});R.displayName=I.ck.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(I.Z0,{ref:s,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",a),...t})}).displayName=I.Z0.displayName;var q=a(4413),T=a(5805),M=a(2718),L=a(7692),V=a(525),$=a(4794),B=a(6439),Y=a(5868),G=a(2369),H=a(3041),J=a(9345),W=a(3774),K=a(9397),Q=a(8930),X=a(7689),ee=a(3581),es=a(4743),ea=a(7072),er=a(6865),et=a(1671),en=a(3247),el=a(1047);let ec=["Bebidas","Snacks y Dulces","L\xe1cteos","Carnes y Embutidos","Frutas y Verduras","Panader\xeda","Granos y Cereales","Enlatados y Conservas","Aseo Personal","Aseo del Hogar","Congelados","Aceites y Condimentos","Galletas y Reposter\xeda","Productos para Beb\xe9","Medicamentos y Salud","Licores","Cigarrillos","Otros"];function ei(){var e,s;let[m,x]=(0,t.useState)(null),[f,b]=(0,t.useState)(null),[y,I]=(0,t.useState)(null),[z,A]=(0,t.useState)(""),[O,U]=(0,t.useState)(""),[ei,eo]=(0,t.useState)("tendero"),[ed,em]=(0,t.useState)({name:"",email:"",password:"",userType:"tendero",storeName:"",phone:""}),[eu,ex]=(0,t.useState)(""),[ep,eh]=(0,t.useState)(""),[eg,ej]=(0,t.useState)({name:"Distribuidora L\xf3pez",businessName:"Distribuidora L\xf3pez S.A.",phone:"+52123456789",email:"contacto@distribuidoralopez.com",address:"Av. Principal 123, Ciudad",description:""}),[ef,ev]=(0,t.useState)(!1),[eN,eb]=(0,t.useState)([]),[ey,ew]=(0,t.useState)(null),[eC,ek]=(0,t.useState)(!1),[eS,eD]=(0,t.useState)({name:"",barcode:"",price:0,stock:0,minStock:0,description:"",discount:0,category:"",image:""}),[eI,ez]=(0,t.useState)(null),[eA,eP]=(0,t.useState)({name:"",price:0,minStock:0,discount:0,category:"",image:""}),[eZ,eF]=(0,t.useState)([]),[eE,eO]=(0,t.useState)("inventory"),[eU,e_]=(0,t.useState)(""),[eR,eq]=(0,t.useState)(null),[eT,eM]=(0,t.useState)(!1),[eL,eV]=(0,t.useState)(null),[e$,eB]=(0,t.useState)(null),[eY,eG]=(0,t.useState)(null),eH=(0,t.useRef)(null),[eJ,eW]=(0,t.useState)(!1),[eK,eQ]=(0,t.useState)(null),eX=(0,t.useRef)(null),e0=(0,t.useRef)(null),e1=(0,t.useRef)(null),e2=(0,t.useRef)(!1),e4=(0,t.useRef)(0),[e3,e5]=(0,t.useState)(!1),[e8,e6]=(0,t.useState)(null),[e7,e9]=(0,t.useState)("1"),[se,ss]=(0,t.useState)(!1),[sa,sr]=(0,t.useState)({name:"",barcode:"",category:"",stock:0,minStock:0,price:0,image:"",description:"",discount:0}),[st,sn]=(0,t.useState)(null),[sl,sc]=(0,t.useState)(!1),[si,so]=(0,t.useState)([]),[sd,sm]=(0,t.useState)(!1),[su,sx]=(0,t.useState)([]),[sp,sh]=(0,t.useState)(!1),[sg,sj]=(0,t.useState)(null),[sf,sv]=(0,t.useState)(""),[sN,sb]=(0,t.useState)([]),[sy,sw]=(0,t.useState)(null),[sC,sk]=(0,t.useState)(1),[sS,sD]=(0,t.useState)(!1),[sI,sz]=(0,t.useState)([]),[sA,sP]=(0,t.useState)(""),[sZ,sF]=(0,t.useState)(""),[sE,sO]=(0,t.useState)([]),[sU,s_]=(0,t.useState)([]),[sR,sq]=(0,t.useState)("all"),[sT,sM]=(0,t.useState)(!1),[sL,sV]=(0,t.useState)(null),[s$,sB]=(0,t.useState)(0),sY=()=>{let e=Date.now().toString(36).toUpperCase(),s=Math.random().toString(36).substring(2,5).toUpperCase();return"PROD-".concat(e,"-").concat(s)},sG=(e,s)=>{ex(e),eh(s),setTimeout(()=>{ex(""),eh("")},3e3)},sH=(e,s)=>0===e?{color:"bg-red-500",text:"Sin Stock",textColor:"text-red-600"}:e<=s?{color:"bg-amber-500",text:"Stock Bajo",textColor:"text-amber-600"}:{color:"bg-green-500",text:"En Stock",textColor:"text-green-600"},sJ=eZ.filter(e=>e.name.toLowerCase().includes(eU.toLowerCase())||e.barcode.includes(eU)),sW=eZ.filter(e=>e.stock<=e.minStock),sK=(e,s)=>{eF(a=>{let r=a.map(a=>a.id===e?{...a,stock:Math.max(0,a.stock+s)}:a);return I((0,n.xq)(e=>({...e,products:r}))),sB(e=>e+1),r})},sQ=async()=>{try{let e;if(console.log("\uD83C\uDFAC Iniciando scanner..."),e2.current){console.log("Scanner ya inicializado, evitando doble inicio");return}e2.current=!0,e4.current+=1,console.log("\uD83D\uDD22 startScanning llamado ".concat(e4.current," veces")),eY&&(console.log("⏹️ Deteniendo stream previo"),eY.getTracks().forEach(e=>e.stop())),eH.current&&(eH.current.srcObject=null),eM(!0),eV(null),eB(null),eQ(null),eG(null),console.log("\uD83D\uDCF1 Solicitando acceso a c\xe1mara...");try{console.log("Intento 1: Con constraints espec\xedficas"),e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720}},audio:!1}),console.log("✅ Intento 1 exitoso")}catch(s){console.warn("❌ Intento 1 fallido:",s);try{console.log("Intento 2: Sin constraints espec\xedficas"),e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1}),console.log("✅ Intento 2 exitoso")}catch(e){throw console.error("❌ Ambos intentos fallidos:",s,e),Error("No hay c\xe1mara disponible. Aseg\xfarate de conectar una c\xe1mara o permitir acceso en navegador.")}}if(console.log("\uD83C\uDFA5 Conectando stream al video elemento..."),eH.current){eH.current.srcObject=e,eG(e),console.log("▶️ Iniciando reproducci\xf3n de video...");let s=eH.current.play();s&&await s.catch(e=>{throw console.error("❌ Error al reproducir video:",e),e}),console.log("✅ Video reproduci\xe9ndose")}console.log("\uD83D\uDD0D Importando scanner de c\xf3digos...");let{BrowserMultiFormatReader:s}=await a.e(263).then(a.bind(a,8263)),r=new s;e0.current=r,console.log("\uD83D\uDD0D Iniciando escaneo continuo..."),await new Promise(e=>setTimeout(e,1500));let t=!0;try{r.decodeFromVideoElement(eH.current,e=>{if(e&&t){let r=e.getText();if(console.log("\uD83D\uDD0D Listener activado para: ".concat(r,", handledBarcodeRef: ").concat(e1.current,", scannerActive: ").concat(t)),e1.current===r){console.log("\uD83D\uDEAB C\xf3digo ".concat(r," ya manejado en listener, ignorando"));return}console.log("✅ C\xf3digo detectado:",r),l(),t=!1;try{var s,a;null===(a=e0.current)||void 0===a||null===(s=a.reset)||void 0===s||s.call(a),console.log("\uD83D\uDD04 codeReader reset desde listener")}catch(e){console.warn("Error resetting codeReader:",e)}eV(r),eW(!0),sX(),e2.current=!1}})}catch(s){console.error("Error en decodificaci\xf3n:",s);let e=async()=>{if(eH.current&&eT&&t){try{let e=await r.decodeOnceFromVideoElement(eH.current);if(e&&t){let r=e.getText();if(console.log("\uD83D\uDD0D Fallback activado para: ".concat(r,", handledBarcodeRef: ").concat(e1.current,", scannerActive: ").concat(t)),e1.current===r){console.log("\uD83D\uDEAB C\xf3digo ".concat(r," ya manejado en fallback, ignorando"));return}console.log("✅ C\xf3digo detectado (fallback):",r),l(),t=!1,eV(r),eW(!0);try{var s,a;null===(a=e0.current)||void 0===a||null===(s=a.reset)||void 0===s||s.call(a),console.log("\uD83D\uDD04 codeReader reset desde fallback")}catch(e){console.warn("Error resetting codeReader (fallback):",e)}sX(),e2.current=!1;return}}catch(e){}t&&eT&&setTimeout(e,100)}};e()}}catch(e){console.error("❌ Error general:",e),c.Am.error("C\xe1mara no disponible: ".concat(e.message||"Verifica los permisos o conecta una c\xe1mara")),eM(!1),e2.current=!1}},sX=()=>{console.log("\uD83D\uDED1 stopScanning llamado"),eM(!1);try{try{var e,s;null===(s=e0.current)||void 0===s||null===(e=s.reset)||void 0===e||e.call(s),console.log("\uD83D\uDD04 codeReader reset llamado")}catch(e){console.warn("Error resetting codeReader on stop:",e)}e0.current=null,eY&&eY.getTracks().forEach(e=>{try{e.stop(),eY.removeTrack(e)}catch(e){console.warn("Error stopping track:",e)}}),eH.current&&(eH.current.pause(),eH.current.srcObject=null),eG(null),e2.current=!1,console.log("✅ stopScanning completado")}catch(e){console.error("Error stopping scanner:",e)}};(0,t.useEffect)(()=>{let e=()=>{eT&&sX()};return"scan"!==eE&&e(),e},[eE,eT]),(0,t.useEffect)(()=>{I((0,n.y0)());let e=localStorage.getItem("loggedInUser");if(e)try{let s=JSON.parse(e);x(s)}catch(e){console.error("Error parsing saved user:",e)}},[]),(0,t.useEffect)(()=>{var e,s;if(!m)return;let a=(0,n.y0)();I(a),eF(a.products),eb(a.supplierProducts),sb(a.chats||[]),sO(a.sales||[]),s_(a.purchases||[]),"proveedor"===m.role?(ej({name:m.name,businessName:m.businessName||m.name,phone:m.phone||"",email:m.email,address:m.address||"",description:m.description||""}),so(((null===(e=a.supplierOffers)||void 0===e?void 0:e.filter(e=>e.supplierId===m.id&&e.isActive))||[]).map(e=>({id:e.id,products:e.products,createdAt:e.createdAt})))):"tendero"===m.role&&so(((null===(s=a.supplierOffers)||void 0===s?void 0:s.filter(e=>e.isActive))||[]).map(e=>({id:e.id,products:e.products,createdAt:e.createdAt,supplier:{name:e.supplierName,businessName:e.supplierBusinessName,phone:e.supplierPhone,email:e.supplierEmail}})));let r=(0,n.y1)();fetch("/data/barcodes.json").then(e=>e.json()).then(e=>{let s={...r};e.forEach(e=>{s[e.barcode]||(s[e.barcode]={name:e.name,price:e.price,image:e.image})}),b(s)}).catch(()=>b(r))},[null==m?void 0:m.id,s$]),(0,t.useEffect)(()=>()=>{eY&&eY.getTracks().forEach(e=>{try{e.stop()}catch(e){console.error("Error stopping track:",e)}})},[eY]),(0,t.useEffect)(()=>{!eJ&&eT&&(console.log("Modal cerrado, deteniendo escaneo"),sX()),eJ||(console.log("\uD83D\uDD13 Limpiando handledBarcodeRef al cerrar confirmScanOpen"),e1.current=null)},[eJ]),(0,t.useEffect)(()=>{e3||(console.log("\uD83D\uDD13 Limpiando handledBarcodeRef al cerrar existingProductModal"),e1.current=null)},[e3]);let s0=async e=>{if(console.log("\uD83D\uDCE5 handleBarcodeDetected llamado con: ".concat(e,", handledBarcodeRef: ").concat(e1.current)),e1.current===e){console.log("\uD83D\uDEAB C\xf3digo ".concat(e," ya est\xe1 siendo manejado, ignorando llamada duplicada"));return}e1.current=e,console.log("\uD83D\uDD12 C\xf3digo ".concat(e," marcado como manejado"));let s=eZ.find(s=>s.barcode===e);if(s){console.log("\uD83D\uDCE6 Producto existente encontrado: ".concat(s.name)),sX(),e3?console.log("⚠️ Modal de producto existente ya est\xe1 abierto, ignorando"):(console.log("\uD83D\uDD13 Abriendo modal de producto existente"),e6(s),e9("1"),e5(!0));return}let a=null==f?void 0:f[e];if(a){console.log("\uD83D\uDCDA Producto encontrado en dataset local: ".concat(a.name));let s={id:Date.now(),name:a.name,barcode:e,stock:1,minStock:5,price:a.price||0,image:a.image||"/placeholder.svg"};eF(e=>{let a=[...e,s];return I((0,n.xq)(e=>({...e,products:a}))),a}),eB(s.name),c.Am.success("Producto ".concat(s.name," agregado al inventario"));return}try{console.log("\uD83C\uDF10 Buscando en Open Food Facts: ".concat(e));let s=await fetch("https://world.openfoodfacts.org/api/v2/product/".concat(e,".json")).then(e=>e.json());if(null==s?void 0:s.product){console.log("\uD83D\uDCDA Producto encontrado en Open Food Facts");let a=s.product.product_name||s.product.brands||"Producto ".concat(e),r=s.product.image_front_small_url||"/placeholder.svg",t={id:Date.now(),name:a,barcode:e,stock:1,minStock:5,price:0,image:r};eF(e=>{let s=[...e,t],a=(0,n.xq)(e=>({...e,products:s}));return I(a),s}),eB(t.name),c.Am.success("".concat(t.name," agregado al inventario"));return}}catch(e){console.error("Error fetching from Open Food Facts:",e)}console.log("❌ C\xf3digo ".concat(e," no encontrado en ning\xfan lado, mostrando modal de nuevo producto")),sX(),sr({name:"",barcode:e,category:"",stock:1,minStock:5,price:0,image:"",description:"",discount:0}),sn(null),eQ(null),c.Am.info("C\xf3digo ".concat(e," no encontrado. Agregando nuevo producto...")),ss(!0)},s1=()=>{x(null),localStorage.removeItem("loggedInUser"),c.Am.info("Has cerrado sesi\xf3n")},s2=e=>{ez(e),eP({name:e.name,price:e.price,minStock:e.minStock,discount:e.discount||0,category:e.category||"",image:e.image||""})},s4=e=>{eF(s=>{let a=s.find(s=>s.id===e),r=s.filter(s=>s.id!==e);return I((0,n.xq)(e=>({...e,products:r}))),a&&e1.current===a.barcode&&(console.log("\uD83D\uDD13 Limpiando handledBarcodeRef al eliminar producto: ".concat(a.barcode)),e1.current=null),r}),c.Am.success("Producto eliminado correctamente")},s3=e=>{if(!m||"proveedor"!==m.role){c.Am.error("Solo los proveedores pueden eliminar sus ofertas");return}I((0,n.xq)(s=>({...s,supplierOffers:s.supplierOffers.filter(s=>s.id!==e.toString()||s.supplierId!==m.id)}))),so(s=>s.filter(s=>s.id!==e)),c.Am.success("Oferta eliminada correctamente")},s5=e=>{ew(e),eP({name:e.name,price:e.price,minStock:e.minStock,discount:e.discount||0,category:e.category||"",image:e.image||""})},s8=e=>{let s=null==y?void 0:y.currentUserId;if(!s)return null;let a=sN.find(a=>a.participant1Id===s&&a.participant2Id===e||a.participant1Id===e&&a.participant2Id===s);return a||(a={id:crypto.randomUUID(),participant1Id:s,participant2Id:e,messages:[],lastMessageAt:new Date().toISOString()},sb(e=>{let s=[...e,a];return I((0,n.xq)(e=>({...e,chats:s}))),s})),a},s6=()=>{if(!sf.trim()||!sg||!(null==y?void 0:y.currentUserId))return;let e=s8(sg.id);if(!e)return;let s={id:crypto.randomUUID(),senderId:y.currentUserId,receiverId:sg.id,message:sf.trim(),timestamp:new Date().toISOString(),read:!1},a=[...e.messages,s];sb(r=>{let t=r.map(r=>r.id===e.id?{...r,messages:a,lastMessageAt:s.timestamp}:r);return I((0,n.xq)(e=>({...e,chats:t}))),t}),sv(""),c.Am.success("Mensaje enviado")},s7=()=>sg&&(null==y?void 0:y.currentUserId)?sN.find(e=>e.participant1Id===y.currentUserId&&e.participant2Id===sg.id||e.participant1Id===sg.id&&e.participant2Id===y.currentUserId):null,s9=()=>{if(!(null==y?void 0:y.currentUserId))return 0;let e=0;return sN.forEach(s=>{s.messages.forEach(s=>{s.receiverId===y.currentUserId&&!s.read&&e++})}),e},ae=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!m||"tendero"!==m.role){c.Am.error("Solo los tenderos pueden agregar productos a su inventario");return}if(s<=0){c.Am.error("La cantidad debe ser mayor a 0");return}let a=null==y?void 0:y.supplierOffers.find(s=>s.products.some(s=>s.id===e.id)),r=eZ.findIndex(s=>s.barcode===e.barcode);if(-1!==r){let a=[...eZ];a[r]={...a[r],stock:a[r].stock+s},eF(a),I((0,n.xq)(e=>({...e,products:a}))),sB(e=>e+1),c.Am.success("✅ Se agregaron ".concat(s," unidades de ").concat(e.name," al inventario existente"))}else{let a=[...eZ,{id:Date.now(),name:e.name,barcode:e.barcode,category:e.category||"Sin categor\xeda",stock:s,minStock:e.minStock||5,price:e.price,image:e.image||"/placeholder.svg",description:e.description||"",discount:e.discount||0,ownerUserId:m.id,catalogType:"tendero"}];eF(a),I((0,n.xq)(e=>({...e,products:a}))),sB(e=>e+1),c.Am.success("✅ ".concat(e.name," agregado al inventario con ").concat(s," unidades"))}if(a){let r={productId:e.id,productName:e.name,quantity:s,unitPrice:e.price,discount:e.discount||0,subtotal:s*e.price*(1-(e.discount||0)/100)};al(a.id,a.supplierName,a.supplierId,[r],r.subtotal)}},as=e=>{sw(e),sk(1),sD(!0)},aa=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(s<=0){c.Am.error("La cantidad debe ser mayor a 0");return}if(s>e.stock){c.Am.error("Solo hay ".concat(e.stock," unidades disponibles"));return}let a=sI.find(s=>s.productId===e.id);if(a){let r=a.quantity+s;if(r>e.stock){c.Am.error("Solo hay ".concat(e.stock," unidades disponibles"));return}sz(s=>s.map(s=>s.productId===e.id?{...s,quantity:r,subtotal:r*s.unitPrice*(1-s.discount/100)}:s))}else{let a=e.discount||0,r=e.price,t={productId:e.id,productName:e.name,quantity:s,unitPrice:r,discount:a,subtotal:s*r*(1-a/100)};sz(e=>[...e,t])}c.Am.success("".concat(e.name," agregado al carrito"))},ar=e=>{sz(s=>s.filter(s=>s.productId!==e))},at=(e,s)=>{console.log("Updating cart item ".concat(e," to quantity ").concat(s));let a=eZ.find(s=>s.id===e);if(a){if(s<=0){ar(e);return}if(s>a.stock){c.Am.error("Solo hay ".concat(a.stock," unidades disponibles"));return}sz(a=>{let r=a.map(a=>a.productId===e?{...a,quantity:s,subtotal:s*a.unitPrice*(1-a.discount/100)}:a);return console.log("Updated cart:",r),r})}},an=()=>{let e=sI.reduce((e,s)=>e+s.quantity*s.unitPrice,0),s=sI.reduce((e,s)=>e+s.quantity*s.unitPrice*s.discount/100,0);return{subtotal:e,totalDiscount:s,total:e-s}},al=(e,s,a,r,t)=>{if(!m||"tendero"!==m.role){c.Am.error("Solo los tenderos pueden registrar compras");return}let l=[...sU,{id:crypto.randomUUID(),tenderoId:m.id,supplierId:a,supplierName:s,offerId:e,items:r,total:t,createdAt:new Date().toISOString()}];s_(l),I((0,n.xq)(e=>({...e,purchases:l}))),c.Am.success("✅ Compra registrada por $".concat(t.toFixed(2)))},ac=()=>{let e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()),a=new Date(s.getTime()-6048e5),r=new Date(s.getTime()-2592e6);return sE.filter(e=>{let t=new Date(e.createdAt);switch(sR){case"today":return t>=s;case"week":return t>=a;case"month":return t>=r;default:return!0}})},ai=e=>{(null==y?void 0:y.currentUserId)&&sb(s=>{let a=s.map(s=>s.id===e?{...s,messages:s.messages.map(e=>e.receiverId!==y.currentUserId||e.read?e:{...e,read:!0})}:s);return I((0,n.xq)(e=>({...e,chats:a}))),a})};return m?(null==m?void 0:m.role)==="proveedor"?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("header",{className:"bg-card border-b border-border p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T.Z,{className:"h-8 w-8 text-primary"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-card-foreground",children:"StockSync Proveedor"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>sh(!0),title:"Mensajes",children:(0,r.jsx)(M.Z,{className:"h-4 w-4"})}),s9()>0&&(0,r.jsx)(u,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center text-xs",children:s9()})]}),(0,r.jsx)(i.z,{variant:"ghost",onClick:s1,children:(0,r.jsx)(L.Z,{className:"h-4 w-4"})})]})]})}),eu&&(0,r.jsx)("div",{className:"max-w-4xl mx-auto p-4",children:(0,r.jsxs)("div",{className:"p-3 rounded-lg flex items-center gap-2 ".concat("success"===ep?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:["success"===ep?(0,r.jsx)(P.Z,{className:"h-4 w-4"}):(0,r.jsx)(v.Z,{className:"h-4 w-4"}),eu]})}),(0,r.jsx)("div",{className:"max-w-4xl mx-auto p-4",children:(0,r.jsxs)(p,{defaultValue:"dashboard",className:"w-full",children:[(0,r.jsxs)(h,{className:"grid w-full grid-cols-3",children:[(0,r.jsxs)(g,{value:"dashboard",children:[(0,r.jsx)(V.Z,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),(0,r.jsxs)(g,{value:"products",children:[(0,r.jsx)($.Z,{className:"h-4 w-4 mr-2"}),"Productos"]}),(0,r.jsxs)(g,{value:"announcements",children:[(0,r.jsx)(B.Z,{className:"h-4 w-4 mr-2"}),"Anuncios"]})]}),(0,r.jsxs)(j,{value:"dashboard",className:"space-y-6",children:[(0,r.jsxs)(o.Zb,{children:[(0,r.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsx)(o.ll,{children:"Mi Perfil de Proveedor"}),(0,r.jsxs)(i.z,{variant:"outline",onClick:()=>ev(!0),children:[(0,r.jsx)(Y.Z,{className:"h-4 w-4 mr-2"}),"Editar"]})]}),(0,r.jsx)(o.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"col-span-1 md:col-span-2 flex items-center gap-2",children:[(0,r.jsx)(q.Z,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"font-bold text-lg text-primary",children:eg.businessName||eg.name})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(G.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"font-medium",children:eg.name})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(H.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:eg.phone})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(J.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:eg.email})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(W.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:eg.address})]}),eg.description&&(0,r.jsxs)("div",{className:"col-span-1 md:col-span-2 flex items-center gap-2",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Descripci\xf3n:"}),(0,r.jsx)("span",{className:"font-medium",children:eg.description})]})]})})]}),(0,r.jsxs)(o.Zb,{children:[(0,r.jsx)(o.Ol,{className:"pb-2",children:(0,r.jsx)(o.ll,{className:"text-sm font-medium",children:"Productos Activos"})}),(0,r.jsxs)(o.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:eN.length}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"En cat\xe1logo"})]})]})]}),(0,r.jsxs)(j,{value:"products",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Mis Productos"}),(0,r.jsxs)(i.z,{onClick:()=>ek(!0),children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Agregar Producto"]})]}),(0,r.jsx)("div",{className:"grid gap-4",children:eN.map(e=>(0,r.jsx)(o.Zb,{children:(0,r.jsx)(o.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-16 h-16 rounded-lg object-cover"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-lg",children:e.name}),(0,r.jsx)("p",{className:"text-muted-foreground",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[e.discount>0?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-muted-foreground line-through",children:["$",e.price]}),(0,r.jsxs)("span",{className:"font-bold text-lg text-primary",children:["$",(e.price*(1-e.discount/100)).toFixed(2)]}),(0,r.jsxs)(u,{variant:"destructive",className:"text-xs",children:["-",e.discount,"%"]})]}):(0,r.jsxs)("span",{className:"font-bold text-lg text-primary",children:["$",e.price]}),(0,r.jsx)(u,{variant:"secondary",children:e.category})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s5(e),children:(0,r.jsx)(Y.Z,{className:"h-4 w-4"})}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>{eb(s=>{let a=s.filter(s=>s.id!==e.id);return I((0,n.xq)(e=>({...e,supplierProducts:a}))),a}),sG("Producto eliminado correctamente","success")},children:(0,r.jsx)(Q.Z,{className:"h-4 w-4 text-red-500"})})]})]})})},e.id))})]}),(0,r.jsxs)(j,{value:"announcements",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Mis Anuncios"}),(0,r.jsxs)(i.z,{onClick:()=>sm(!0),children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Crear Anuncio"]})]}),(0,r.jsx)("div",{className:"grid gap-4",children:0===si.length?(0,r.jsx)(o.Zb,{children:(0,r.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,r.jsx)(B.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-lg font-medium mb-2",children:"No tienes anuncios publicados"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Crea un anuncio para que los clientes vean tus productos"}),(0,r.jsxs)(i.z,{onClick:()=>sm(!0),children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Crear Primer Anuncio"]})]})}):si.map(e=>(0,r.jsxs)(o.Zb,{children:[(0,r.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)(o.ll,{className:"text-lg",children:["Anuncio - ",e.products.length," productos"]}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s3(e.id),children:(0,r.jsx)(Q.Z,{className:"h-4 w-4 text-red-500"})})]}),(0,r.jsx)(o.aY,{children:(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:e.products.map(e=>(0,r.jsxs)("div",{className:"p-3 bg-muted rounded-lg",children:[(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-full h-20 rounded object-cover mb-2"}),(0,r.jsx)("p",{className:"text-sm font-medium truncate",children:e.name}),e.discount>0?(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("span",{className:"text-xs text-muted-foreground line-through",children:["$",e.price]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-primary",children:["$",(e.price*(1-e.discount/100)).toFixed(2)]})]}):(0,r.jsxs)("p",{className:"text-sm font-bold text-primary",children:["$",e.price]})]},e.id))})})]},e.id))})]})]})}),(0,r.jsx)(N,{open:ef,onOpenChange:ev,children:(0,r.jsxs)(w,{className:"max-w-md mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Editar Perfil de Proveedor"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"supplierBusinessName",children:"Nombre del Negocio/Empresa"}),(0,r.jsx)(d.I,{id:"supplierBusinessName",placeholder:"Ej: Distribuidora L\xf3pez S.A.",value:eg.businessName,onChange:e=>ej(s=>({...s,businessName:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"supplierName",children:"Nombre del Contacto"}),(0,r.jsx)(d.I,{id:"supplierName",placeholder:"Ej: Juan L\xf3pez",value:eg.name,onChange:e=>ej(s=>({...s,name:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"supplierPhone",children:"Tel\xe9fono de Contacto"}),(0,r.jsx)(d.I,{id:"supplierPhone",value:eg.phone,onChange:e=>ej(s=>({...s,phone:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"supplierEmail",children:"Correo Electr\xf3nico"}),(0,r.jsx)(d.I,{id:"supplierEmail",type:"email",value:eg.email,onChange:e=>ej(s=>({...s,email:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"supplierAddress",children:"Direcci\xf3n"}),(0,r.jsx)(d.I,{id:"supplierAddress",value:eg.address,onChange:e=>ej(s=>({...s,address:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"supplierDescription",children:"Descripci\xf3n del Negocio"}),(0,r.jsx)(D,{id:"supplierDescription",placeholder:"Describe tu negocio y productos...",value:eg.description,onChange:e=>ej(s=>({...s,description:e.target.value}))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>ev(!1),className:"flex-1",children:"Cancelar"}),(0,r.jsx)(i.z,{onClick:()=>{(null==y?void 0:y.currentUserId)&&(I((0,n.xq)(e=>({...e,users:e.users.map(e=>e.id===y.currentUserId?{...e,name:eg.name,businessName:eg.businessName,phone:eg.phone,email:eg.email,address:eg.address,description:eg.description}:e)}))),ev(!1),c.Am.success("Perfil actualizado exitosamente"))},className:"flex-1",children:"Guardar"})]})]})]})}),(0,r.jsx)(N,{open:!!ey,onOpenChange:()=>ew(null),children:(0,r.jsxs)(w,{className:"max-w-sm mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Editar Producto"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"productName",children:"Nombre del Producto"}),(0,r.jsx)(d.I,{id:"productName",value:eA.name,onChange:e=>eP(s=>({...s,name:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"productPrice",children:"Precio"}),(0,r.jsx)(d.I,{id:"productPrice",type:"number",step:"0.01",value:eA.price,onChange:e=>eP(s=>({...s,price:Number.parseFloat(e.target.value)}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"productCategory",children:"Categor\xeda"}),(0,r.jsxs)(Z,{value:eA.category,onValueChange:e=>eP(s=>({...s,category:e})),children:[(0,r.jsx)(E,{children:(0,r.jsx)(F,{placeholder:"Selecciona una categor\xeda"})}),(0,r.jsx)(_,{children:ec.map(e=>(0,r.jsx)(R,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"productDiscount",children:"Descuento (%)"}),(0,r.jsx)(d.I,{id:"productDiscount",type:"number",min:"0",max:"100",value:eA.discount,onChange:e=>eP(s=>({...s,discount:Number.parseInt(e.target.value)||0}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{children:"Imagen del Producto"}),eA.image&&(0,r.jsxs)("div",{className:"mb-3 relative",children:[(0,r.jsx)("img",{src:eA.image,alt:eA.name||"Producto",className:"w-full h-32 rounded-lg object-cover border"}),(0,r.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>eP(e=>({...e,image:""})),className:"absolute top-2 right-2",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>{var e;return null===(e=document.getElementById("editProductImageInput"))||void 0===e?void 0:e.click()},children:[(0,r.jsx)(X.Z,{className:"h-4 w-4 mr-2"}),"Cargar Imagen"]}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",children:[(0,r.jsx)(ee.Z,{className:"h-4 w-4 mr-2"}),"Capturar"]})]}),(0,r.jsx)("input",{id:"editProductImageInput",type:"file",accept:"image/*",className:"hidden",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(a){let e=new FileReader;e.onload=e=>{eP(s=>{var a;return{...s,image:null===(a=e.target)||void 0===a?void 0:a.result}})},e.readAsDataURL(a)}}})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>ew(null),className:"flex-1",children:"Cancelar"}),(0,r.jsx)(i.z,{onClick:()=>{eb(e=>{let s=e.map(e=>e.id===ey.id?{...e,...eA}:e);return I((0,n.xq)(e=>({...e,supplierProducts:s}))),s}),ew(null)},className:"flex-1",children:"Guardar"})]})]})]})}),(0,r.jsx)(N,{open:eC,onOpenChange:ek,children:(0,r.jsxs)(w,{className:"max-w-md mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Agregar Nuevo Producto"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductName",children:"Nombre del Producto *"}),(0,r.jsx)(d.I,{id:"newProductName",placeholder:"Ej: Coca Cola 2L",value:eS.name,onChange:e=>eD(s=>({...s,name:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductBarcode",children:"C\xf3digo de Barras"}),(0,r.jsx)(d.I,{id:"newProductBarcode",placeholder:"Ej: 123456789012",value:eS.barcode,onChange:e=>eD(s=>({...s,barcode:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductPrice",children:"Precio *"}),(0,r.jsx)(d.I,{id:"newProductPrice",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:eS.price||"",onChange:e=>eD(s=>({...s,price:Number.parseFloat(e.target.value)||0}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductCategory",children:"Categor\xeda *"}),(0,r.jsxs)(Z,{value:eS.category,onValueChange:e=>eD(s=>({...s,category:e})),children:[(0,r.jsx)(E,{children:(0,r.jsx)(F,{placeholder:"Selecciona una categor\xeda"})}),(0,r.jsx)(_,{children:ec.map(e=>(0,r.jsx)(R,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductDescription",children:"Descripci\xf3n"}),(0,r.jsx)(D,{id:"newProductDescription",placeholder:"Descripci\xf3n del producto...",value:eS.description,onChange:e=>eD(s=>({...s,description:e.target.value}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductStock",children:"Stock Disponible"}),(0,r.jsx)(d.I,{id:"newProductStock",type:"number",min:"0",placeholder:"0",value:eS.stock||"",onChange:e=>eD(s=>({...s,stock:Number.parseInt(e.target.value)||0}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductMinStock",children:"Stock M\xednimo"}),(0,r.jsx)(d.I,{id:"newProductMinStock",type:"number",min:"0",placeholder:"5",value:eS.minStock||"",onChange:e=>eD(s=>({...s,minStock:Number.parseInt(e.target.value)||0}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"newProductDiscount",children:"Descuento (%)"}),(0,r.jsx)(d.I,{id:"newProductDiscount",type:"number",min:"0",max:"100",placeholder:"0",value:eS.discount||"",onChange:e=>eD(s=>({...s,discount:Number.parseInt(e.target.value)||0}))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{children:"Imagen del Producto"}),eS.image&&(0,r.jsxs)("div",{className:"mb-3 relative",children:[(0,r.jsx)("img",{src:eS.image,alt:eS.name||"Producto",className:"w-full h-32 rounded-lg object-cover border"}),(0,r.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>eD(e=>({...e,image:""})),className:"absolute top-2 right-2",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>{var e;return null===(e=document.getElementById("supplierProductImageInput"))||void 0===e?void 0:e.click()},children:[(0,r.jsx)(X.Z,{className:"h-4 w-4 mr-2"}),"Cargar Imagen"]}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",children:[(0,r.jsx)(ee.Z,{className:"h-4 w-4 mr-2"}),"Capturar"]})]}),(0,r.jsx)("input",{id:"supplierProductImageInput",type:"file",accept:"image/*",className:"hidden",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(a){let e=new FileReader;e.onload=e=>{eD(s=>{var a;return{...s,image:null===(a=e.target)||void 0===a?void 0:a.result}})},e.readAsDataURL(a)}}})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>ek(!1),className:"flex-1",children:"Cancelar"}),(0,r.jsx)(i.z,{onClick:()=>{if(!eS.name.trim()){c.Am.error("Por favor ingrese el nombre del producto");return}if(!eS.price||eS.price<=0){c.Am.error("Por favor ingrese un precio v\xe1lido");return}if(!eS.category.trim()){c.Am.error("Por favor ingrese la categor\xeda del producto");return}let e=eN.length>0?Math.max(...eN.map(e=>e.id))+1:1,s={...eS,id:e,barcode:eS.barcode||"SUP-".concat(Date.now()),image:eS.image||eS.image||"/placeholder.svg",stock:eS.stock||0,minStock:eS.minStock||0,ownerUserId:null==y?void 0:y.currentUserId,catalogType:"proveedor"};eb(e=>{let a=[...e,s];return I((0,n.xq)(e=>({...e,supplierProducts:a}))),a}),eD({name:"",barcode:"",price:0,stock:0,minStock:0,description:"",discount:0,category:"",image:""}),ek(!1),c.Am.success('Producto "'.concat(s.name,'" agregado exitosamente'))},className:"flex-1",children:"Agregar"})]})]})]})}),(0,r.jsx)(N,{open:sd,onOpenChange:sm,children:(0,r.jsxs)(w,{className:"max-w-2xl mx-auto max-h-[80vh] overflow-y-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Crear Nuevo Anuncio"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Selecciona los productos que deseas publicar en este anuncio"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3",children:eN.map(e=>(0,r.jsxs)("div",{className:"p-3 border-2 rounded-lg cursor-pointer transition-all ".concat(su.includes(e.id)?"border-primary bg-primary/5":"border-border hover:border-primary/50"),onClick:()=>{sx(s=>s.includes(e.id)?s.filter(s=>s!==e.id):[...s,e.id])},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded border-2 flex items-center justify-center ".concat(su.includes(e.id)?"bg-primary border-primary":"border-border"),children:su.includes(e.id)&&(0,r.jsx)(P.Z,{className:"h-3 w-3 text-white"})}),(0,r.jsx)("span",{className:"font-medium text-sm",children:e.name}),e.category&&(0,r.jsx)(u,{className:"ml-auto",variant:"secondary",children:e.category})]}),(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-full h-20 rounded object-cover mb-2"}),e.discount>0?(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("span",{className:"text-xs text-muted-foreground line-through",children:["$",e.price]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-primary",children:["$",(e.price*(1-e.discount/100)).toFixed(2)]}),(0,r.jsxs)(u,{variant:"destructive",className:"text-xs ml-1",children:["-",e.discount,"%"]})]}):(0,r.jsxs)("p",{className:"text-sm font-bold text-primary",children:["$",e.price]})]},e.id))}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>sm(!1),className:"flex-1",children:"Cancelar"}),(0,r.jsxs)(i.z,{onClick:()=>{if(0===su.length){c.Am.error("Seleccione al menos un producto para publicar");return}if(!m||"proveedor"!==m.role){c.Am.error("Solo los proveedores pueden crear ofertas");return}let e=eN.filter(e=>su.includes(e.id)),s={id:crypto.randomUUID(),supplierId:m.id,supplierName:m.name,supplierBusinessName:m.businessName,supplierPhone:m.phone,supplierEmail:m.email,products:e,createdAt:new Date().toISOString(),isActive:!0};I((0,n.xq)(e=>({...e,supplierOffers:[...e.supplierOffers,s]})));let a={id:s.id,products:e,createdAt:new Date().toISOString()};so(e=>[...e,a]),sx([]),sm(!1),c.Am.success("Oferta publicada correctamente y visible para todos los tenderos")},className:"flex-1",children:["Publicar Anuncio (",su.length," ","productos)"]})]})]})]})})]}),(0,r.jsx)(N,{open:sp,onOpenChange:sh,children:(0,r.jsxs)(w,{className:"max-w-md mx-auto h-[600px] flex flex-col p-0",children:[(0,r.jsx)(C,{className:"p-4 border-b",children:(0,r.jsxs)(k,{className:"flex items-center gap-2",children:[(0,r.jsx)(M.Z,{className:"h-5 w-5"}),"Mensajes"]})}),sg?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-3 border-b flex items-center gap-2",children:[(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>sj(null),children:"← Atr\xe1s"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-medium",children:sg.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:sg.storeName||sg.email})]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-muted/20",children:(()=>{let e=s7();return e&&0!==e.messages.length?e.messages.map(e=>{let s=e.senderId===(null==y?void 0:y.currentUserId);return(0,r.jsx)("div",{className:"flex ".concat(s?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-[75%] rounded-lg p-3 ".concat(s?"bg-primary text-primary-foreground":"bg-background border"),children:[(0,r.jsx)("p",{className:"text-sm break-words",children:e.message}),(0,r.jsx)("p",{className:"text-xs mt-1 ".concat(s?"text-primary-foreground/70":"text-muted-foreground"),children:new Date(e.timestamp).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})})]})},e.id)}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(M.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay mensajes a\xfan. \xa1Inicia la conversaci\xf3n!"})]})})()}),(0,r.jsx)("div",{className:"p-4 border-t bg-background",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s6()},className:"flex gap-2",children:[(0,r.jsx)(d.I,{value:sf,onChange:e=>sv(e.target.value),placeholder:"Escribe un mensaje...",className:"flex-1",autoFocus:!0}),(0,r.jsx)(i.z,{type:"submit",size:"icon",disabled:!sf.trim(),children:(0,r.jsx)(es.Z,{className:"h-4 w-4"})})]})})]}):(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:(null==m?void 0:m.role)==="proveedor"?"Contactar Clientes":"Contactar Proveedores"}),(0,r.jsx)("div",{className:"space-y-2",children:((null==m?void 0:m.role)==="proveedor"?(null==y?void 0:y.users.filter(e=>"tendero"===e.role))||[]:(null==y?void 0:y.users.filter(e=>"proveedor"===e.role))||[]).map(e=>{let s=sN.find(s=>s.participant1Id===(null==y?void 0:y.currentUserId)&&s.participant2Id===e.id||s.participant1Id===e.id&&s.participant2Id===(null==y?void 0:y.currentUserId)),a=(null==s?void 0:s.messages.filter(e=>e.receiverId===(null==y?void 0:y.currentUserId)&&!e.read).length)||0,t=null==s?void 0:s.messages[s.messages.length-1];return(0,r.jsx)(o.Zb,{className:"cursor-pointer hover:bg-muted transition-colors",onClick:()=>{sj(e),s&&ai(s.id)},children:(0,r.jsx)(o.aY,{className:"p-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"bg-primary rounded-full p-2 flex-shrink-0",children:(null==m?void 0:m.role)==="proveedor"?(0,r.jsx)(q.Z,{className:"h-5 w-5 text-primary-foreground"}):(0,r.jsx)(T.Z,{className:"h-5 w-5 text-primary-foreground"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h4",{className:"font-medium truncate",children:e.name}),a>0&&(0,r.jsx)(u,{variant:"destructive",className:"ml-2",children:a})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.storeName||e.email}),t&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground truncate mt-1",children:[t.senderId===(null==y?void 0:y.currentUserId)?"T\xfa: ":"",t.message]})]})]})})},e.id)})})]}),sN.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Conversaciones Recientes"}),(0,r.jsx)("div",{className:"space-y-2",children:sN.filter(e=>e.messages.length>0).sort((e,s)=>new Date(s.lastMessageAt).getTime()-new Date(e.lastMessageAt).getTime()).slice(0,5).map(e=>{let s=e.participant1Id===(null==y?void 0:y.currentUserId)?e.participant2Id:e.participant1Id,a=null==y?void 0:y.users.find(e=>e.id===s);if(!a)return null;let t=e.messages.filter(e=>e.receiverId===(null==y?void 0:y.currentUserId)&&!e.read).length,n=e.messages[e.messages.length-1];return(0,r.jsx)(o.Zb,{className:"cursor-pointer hover:bg-muted transition-colors",onClick:()=>{sj(a),ai(e.id)},children:(0,r.jsx)(o.aY,{className:"p-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"bg-muted rounded-full p-2 flex-shrink-0",children:(0,r.jsx)(M.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h4",{className:"font-medium truncate",children:a.name}),t>0&&(0,r.jsx)(u,{variant:"destructive",className:"ml-2",children:t})]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[n.senderId===(null==y?void 0:y.currentUserId)?"T\xfa: ":"",n.message]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(n.timestamp).toLocaleString("es-CO",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"short"})})]})]})})},e.id)})})]})]})})]})})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("header",{className:"bg-card border-b border-border p-4 sticky top-0 z-50 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"bg-primary rounded-lg p-2",children:(0,r.jsx)(q.Z,{className:"h-6 w-6 text-primary-foreground"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-card-foreground",children:"StockSync"}),(null==y?void 0:y.currentUserId)&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:(null===(e=y.users.find(e=>e.id===y.currentUserId))||void 0===e?void 0:e.storeName)||(null===(s=y.users.find(e=>e.id===y.currentUserId))||void 0===s?void 0:s.name)})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[sW.length>0&&(0,r.jsxs)(u,{variant:"destructive",className:"bg-red-500 text-white animate-pulse",children:[sW.length," ",1===sW.length?"Alerta":"Alertas"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>sh(!0),title:"Mensajes",children:(0,r.jsx)(M.Z,{className:"h-4 w-4"})}),s9()>0&&(0,r.jsx)(u,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center text-xs",children:s9()})]}),(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:s1,title:"Cerrar sesi\xf3n",children:(0,r.jsx)(L.Z,{className:"h-4 w-4"})})]})]})}),eu&&(0,r.jsx)("div",{className:"max-w-md mx-auto p-4",children:(0,r.jsxs)("div",{className:"p-3 rounded-lg flex items-center gap-2 ".concat("success"===ep?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:["success"===ep?(0,r.jsx)(P.Z,{className:"h-4 w-4"}):(0,r.jsx)(v.Z,{className:"h-4 w-4"}),eu]})}),(0,r.jsx)("div",{className:"max-w-md mx-auto",children:(0,r.jsxs)(p,{value:eE,onValueChange:eO,className:"w-full",children:[(0,r.jsxs)(h,{className:"grid w-full grid-cols-4 m-4",children:[(0,r.jsxs)(g,{value:"scan",className:"flex items-center gap-2",children:[(0,r.jsx)(ea.Z,{className:"h-4 w-4"}),"Escanear"]}),(0,r.jsxs)(g,{value:"inventory",className:"flex items-center gap-2",children:[(0,r.jsx)($.Z,{className:"h-4 w-4"}),"Inventario"]}),(0,r.jsxs)(g,{value:"alerts",className:"flex items-center gap-2",children:[(0,r.jsx)(er.Z,{className:"h-4 w-4"}),"Alertas"]}),(0,r.jsxs)(g,{value:"suppliers",className:"flex items-center gap-2",children:[(0,r.jsx)(B.Z,{className:"h-4 w-4"}),"Ofertas"]}),(0,r.jsxs)(g,{value:"billing",className:"flex items-center gap-2",children:[(0,r.jsx)(V.Z,{className:"h-4 w-4"}),"Facturaci\xf3n"]})]}),(0,r.jsxs)(j,{value:"scan",className:"p-4 space-y-4",children:[(0,r.jsxs)(o.Zb,{children:[(0,r.jsx)(o.Ol,{className:"text-center",children:(0,r.jsx)(o.ll,{className:"text-xl",children:"Registrar Mercanc\xeda"})}),(0,r.jsxs)(o.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative bg-black rounded-lg overflow-hidden",style:{minHeight:"500px",height:"500px"},children:[eT&&(0,r.jsx)("video",{ref:eH,className:"absolute inset-0 w-full h-full object-cover",style:{width:"100%",height:"100%",objectFit:"cover"},autoPlay:!0,playsInline:!0,muted:!0,crossOrigin:"anonymous"}),eT&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,r.jsx)("div",{className:"border-4 border-green-500 w-64 h-64 rounded-lg animate-pulse"})}),!eT&&(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center space-y-4 text-white",children:[(0,r.jsx)(ee.Z,{className:"h-16 w-16 mx-auto text-gray-400"}),(0,r.jsx)("p",{className:"text-lg",children:'Presiona "Escanear" para iniciar'})]})}),eT&&!eL&&eY&&(0,r.jsxs)("div",{className:"absolute bottom-4 left-0 right-0 text-center space-y-2 z-10 bg-black/50 p-4 rounded-t-lg",children:[(0,r.jsx)("p",{className:"text-lg font-medium text-white",children:"Apunte la c\xe1mara al c\xf3digo de barras"}),(0,r.jsx)("div",{className:"w-full h-1 bg-white/20 rounded",children:(0,r.jsx)("div",{className:"h-full bg-primary rounded animate-pulse w-full"})})]}),eL&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-20",children:(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)(et.Z,{className:"h-16 w-16 text-green-500 mx-auto"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[e$," detectado"]}),(0,r.jsx)("p",{className:"text-sm text-white",children:"Producto escaneado correctamente"})]})})]}),(0,r.jsx)(i.z,{onClick:sQ,disabled:eT,className:"w-full h-14 text-lg",size:"lg",children:eT?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ee.Z,{className:"h-5 w-5 mr-2 animate-pulse"}),"Escaneando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ee.Z,{className:"h-5 w-5 mr-2"}),"Iniciar Escaneo"]})}),eT&&(0,r.jsxs)(i.z,{onClick:sX,variant:"outline",className:"w-full h-14 text-lg",size:"lg",children:[(0,r.jsx)(v.Z,{className:"h-5 w-5 mr-2"}),"Detener Escaneo"]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"\xbfNo tienes c\xf3digo de barras?"}),(0,r.jsxs)(i.z,{variant:"outline",onClick:()=>ss(!0),className:"w-full",children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Agregar Producto Manualmente"]})]})]})]}),(0,r.jsx)(N,{open:eJ,onOpenChange:eW,children:(0,r.jsxs)(w,{className:"max-w-sm mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Confirmar producto escaneado"})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsx)("strong",{children:"C\xf3digo de barras:"})," ",eL]}),!eK&&eH.current&&eY&&(0,r.jsxs)(i.z,{variant:"outline",onClick:()=>{let e=eH.current;if(!e)return;let s=eX.current||document.createElement("canvas");s.width=e.videoWidth,s.height=e.videoHeight;let a=s.getContext("2d");a&&(a.drawImage(e,0,0,s.width,s.height),eQ(s.toDataURL("image/jpeg",.85)))},className:"w-full",children:[(0,r.jsx)(ee.Z,{className:"h-4 w-4 mr-2"}),"Tomar foto del producto (opcional)"]}),eK&&(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:eK,alt:"captured",className:"w-full rounded"}),(0,r.jsx)(i.z,{variant:"ghost",size:"sm",className:"absolute top-2 right-2",onClick:()=>eQ(null),children:(0,r.jsx)(v.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("canvas",{ref:eX,className:"hidden"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",className:"flex-1",onClick:()=>{eW(!1)},children:"Cancelar"}),(0,r.jsxs)(i.z,{className:"flex-1",onClick:async()=>{if(!eL){eW(!1);return}try{await s0(eL),eK&&eF(e=>{let s=[...e],a=s.findIndex(e=>e.barcode===eL);if(a>=0){s[a]={...s[a],image:eK};let e=(0,n.xq)(e=>({...e,products:s}));I(e)}return s})}catch(e){console.error("Error processing barcode:",e),c.Am.error("Error al procesar el c\xf3digo de barras")}eB(null),eV(null),eQ(null),eW(!1),console.log("\uD83D\uDD13 Limpiando handledBarcodeRef al confirmar scan"),e1.current=null},children:[(0,r.jsx)(P.Z,{className:"h-4 w-4 mr-2"}),"Confirmar"]})]})]})]})}),(0,r.jsx)(N,{open:e3,onOpenChange:e5,children:(0,r.jsxs)(w,{className:"max-w-md mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsxs)(k,{className:"flex items-center gap-2",children:[(0,r.jsx)(et.Z,{className:"h-5 w-5 text-green-600"}),"Producto encontrado"]})}),e8&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,r.jsx)("p",{className:"text-sm text-green-800",children:"✅ Este producto ya existe en tu inventario"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("img",{src:e8.image||"/placeholder.svg",alt:e8.name,className:"w-full h-40 rounded-lg object-cover"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-lg",children:e8.name}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["C\xf3digo: ",e8.barcode]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"bg-muted p-3 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Stock actual"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:e8.stock})]}),(0,r.jsxs)("div",{className:"bg-muted p-3 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Precio"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-primary",children:["$",e8.price]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-blue-900",children:"\xbfCu\xe1ntas unidades deseas agregar?"}),(0,r.jsx)(d.I,{type:"number",min:"1",value:e7,onChange:e=>e9(e.target.value),className:"mt-2"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",className:"flex-1",onClick:()=>{console.log("\uD83D\uDD13 Limpiando handledBarcodeRef al cancelar existingProductModal"),e5(!1),e6(null),e1.current=null},children:"Cancelar"}),(0,r.jsxs)(i.z,{className:"flex-1",onClick:()=>{let e=Number.parseInt(e7)||1;if(e<0){let s={id:crypto.randomUUID(),tenderoId:(null==m?void 0:m.id)||"anonimo",items:[{productId:e8.id,productName:e8.name,quantity:Math.abs(e),unitPrice:e8.price,discount:e8.discount||0,subtotal:Math.abs(e)*e8.price*(1-(e8.discount||0)/100)}],subtotal:Math.abs(e)*e8.price,totalDiscount:0,total:Math.abs(e)*e8.price,createdAt:new Date().toISOString(),customerName:"anonimo",notes:"Venta autom\xe1tica por escaneo negativo"};sO(e=>[...e,s]),eF(a=>{let r=a.map(s=>s.id===e8.id?{...s,stock:s.stock+e}:s);return I((0,n.xq)(e=>({...e,products:r,sales:[...e.sales||[],s]}))),r}),c.Am.success("Venta registrada: ".concat(e8.name," x ").concat(Math.abs(e)," a anonimo"))}else eF(s=>{let a=s.map(s=>s.id===e8.id?{...s,stock:s.stock+e}:s);return I((0,n.xq)(e=>({...e,products:a}))),a}),c.Am.success("".concat(e8.name,": +").concat(e," unidad").concat(e>1?"es":""));e5(!1),e6(null),e9("1"),e1.current=null},children:[(0,r.jsx)(P.Z,{className:"h-4 w-4 mr-2"}),"Confirmar y agregar"]})]})]})]})})]}),(0,r.jsxs)(j,{value:"inventory",className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Mi Inventario"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[eZ.length," ",1===eZ.length?"producto":"productos"," en total"]})]}),(0,r.jsxs)(i.z,{onClick:()=>ss(!0),size:"sm",className:"gap-2",children:[(0,r.jsx)(K.Z,{className:"h-4 w-4"}),"Agregar"]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(en.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(d.I,{placeholder:"Buscar productos...",value:eU,onChange:e=>e_(e.target.value),className:"pl-10 h-12 text-base"})]}),0===sJ.length&&eU&&(0,r.jsxs)(o.Zb,{className:"p-8 text-center",children:[(0,r.jsx)(en.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-lg font-medium mb-1",children:"No se encontraron productos"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Intenta con otro t\xe9rmino de b\xfasqueda"})]}),0===sJ.length&&!eU&&(0,r.jsxs)(o.Zb,{className:"p-8 text-center",children:[(0,r.jsx)($.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-lg font-medium mb-1",children:"No hay productos a\xfan"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Comienza escaneando productos o agr\xe9galos manualmente"}),(0,r.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,r.jsxs)(i.z,{onClick:()=>eO("scan"),variant:"outline",children:[(0,r.jsx)(ea.Z,{className:"h-4 w-4 mr-2"}),"Escanear"]}),(0,r.jsxs)(i.z,{onClick:()=>ss(!0),children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Agregar"]})]})]}),(0,r.jsx)("div",{className:"space-y-3",children:sJ.map(e=>{let s=sH(e.stock,e.minStock);return(0,r.jsx)(o.Zb,{className:"hover:shadow-md transition-shadow",children:(0,r.jsx)(o.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-16 h-16 rounded-lg object-cover border"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"font-semibold text-base truncate",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:e.barcode}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(s.color)}),(0,r.jsx)("span",{className:"text-xl font-bold",children:e.stock}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"unidades"}),e.price>0&&(0,r.jsxs)("span",{className:"ml-auto text-sm font-medium text-primary",children:["$",e.price.toFixed(2)]})]},"stock-".concat(e.id,"-").concat(e.stock))]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s2(e),title:"Editar producto",children:(0,r.jsx)(Y.Z,{className:"h-4 w-4"})}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s4(e.id),title:"Eliminar producto",children:(0,r.jsx)(Q.Z,{className:"h-4 w-4 text-red-500"})}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>eq(e),title:"Ver detalles",children:(0,r.jsx)($.Z,{className:"h-4 w-4"})})]})]})})},e.id)})})]}),(0,r.jsxs)(j,{value:"alerts",className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-1",children:"Alertas de Stock"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Productos que necesitan ser reabastecidos"})]}),(0,r.jsxs)(o.Zb,{children:[(0,r.jsx)(o.Ol,{children:(0,r.jsxs)(o.ll,{className:"flex items-center gap-2 text-lg",children:[(0,r.jsx)(er.Z,{className:"h-5 w-5 text-amber-600"}),(0,r.jsxs)("span",{className:"text-amber-600",children:[sW.length," ",1===sW.length?"Producto":"Productos"," ","con Stock Bajo"]})]})}),(0,r.jsx)(o.aY,{className:"space-y-4",children:0===sW.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(et.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-lg font-medium mb-1",children:"\xa1Todo en orden!"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay productos con stock bajo en este momento"})]}):sW.map(e=>(0,r.jsx)(o.Zb,{className:"border-amber-200 bg-amber-50/50",children:(0,r.jsxs)(o.aY,{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-16 h-16 rounded-lg object-cover border"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-base",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:e.barcode}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(u,{variant:"destructive",className:"text-xs font-medium",children:[e.stock," ",1===e.stock?"unidad":"unidades"]}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Stock m\xednimo: ",e.minStock]})]})]}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>sK(e.id,1),title:"Agregar 1 unidad",children:(0,r.jsx)(K.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"mt-4 pt-3 border-t",children:[(0,r.jsxs)("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[(0,r.jsx)(B.Z,{className:"h-4 w-4"}),"Ofertas de Proveedores:"]}),(()=>{let s=e.name.toLowerCase(),a=s.split(" "),t=eN.filter(e=>e.name.toLowerCase()===s),n=eN.filter(e=>{let s=e.name.toLowerCase();return a.some(e=>e.length>3&&s.includes(e))}),l=e.category?eN.filter(s=>s.category&&s.category.toLowerCase()===e.category.toLowerCase()):[],c=eN.filter(s=>s.category&&s.category!==e.category),o=new Map;t.forEach(e=>o.set(e.id,{...e,priority:1})),n.forEach(e=>{o.has(e.id)||o.set(e.id,{...e,priority:2})}),l.forEach(e=>{o.has(e.id)||o.set(e.id,{...e,priority:3})}),c.slice(0,2).forEach(e=>{o.has(e.id)||o.set(e.id,{...e,priority:4})});let d=Array.from(o.values()).sort((e,s)=>e.priority-s.priority).slice(0,5);return 0===d.length?(0,r.jsxs)("div",{className:"bg-background p-4 rounded-lg border",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"No hay ofertas disponibles para este producto."}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"\uD83D\uDCAC Puedes contactar directamente a proveedores mediante el chat"})]}):(0,r.jsxs)("div",{className:"space-y-2",children:[d.map(e=>{let s=1===e.priority?"Producto id\xe9ntico":2===e.priority?"Producto similar":3===e.priority?"Categor\xeda: ".concat(e.category):"Alternativa";return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-background rounded-lg border hover:border-primary transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-10 h-10 rounded object-cover"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"font-medium text-sm truncate",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.category&&(0,r.jsx)(u,{variant:"secondary",className:"text-xs",children:e.category}),(0,r.jsx)(u,{variant:"outline",className:"text-xs",children:s})]})]})]}),(0,r.jsx)("div",{className:"text-right ml-2",children:e.discount>0?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-xs text-muted-foreground line-through",children:["$",e.price]}),(0,r.jsxs)("p",{className:"font-bold text-primary",children:["$",(e.price*(1-e.discount/100)).toFixed(2)]}),(0,r.jsxs)(u,{variant:"destructive",className:"text-xs",children:["-",e.discount,"%"]})]}):(0,r.jsxs)("p",{className:"font-bold text-primary text-lg",children:["$",e.price]})})]},e.id)}),(0,r.jsx)("div",{className:"text-center pt-2",children:(0,r.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>{sh(!0)},children:[(0,r.jsx)(M.Z,{className:"h-4 w-4 mr-2"}),"Contactar Proveedores"]})})]})})()]})]})},e.id))})]})]}),(0,r.jsxs)(j,{value:"suppliers",className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-500/10 via-primary/10 to-blue-500/10 p-6 rounded-lg border-2 border-primary/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"bg-primary rounded-full p-2",children:(0,r.jsx)(B.Z,{className:"h-6 w-6 text-primary-foreground"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Ofertas Especiales"})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Descubre las mejores ofertas de nuestros proveedores verificados"})]}),0===si.length?(0,r.jsxs)(o.Zb,{className:"p-8 text-center",children:[(0,r.jsx)(B.Z,{className:"h-16 w-16 text-muted-foreground mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-lg font-medium mb-1",children:"No hay ofertas disponibles"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Los proveedores a\xfan no han publicado ofertas"})]}):(0,r.jsx)("div",{className:"space-y-4",children:si.map(e=>(0,r.jsxs)(o.Zb,{className:"overflow-hidden",children:[(0,r.jsx)(o.Ol,{className:"bg-muted/50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(o.ll,{className:"text-base",children:["Oferta - ",e.products.length," ",1===e.products.length?"producto":"productos"]}),e.supplier&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)(q.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:e.supplier.businessName||e.supplier.name}),e.supplier.phone&&(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["• ",e.supplier.phone]})]})]}),(0,r.jsx)(u,{variant:"secondary",children:new Date(e.createdAt).toLocaleDateString("es-CO")})]})}),(0,r.jsxs)(o.aY,{className:"p-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:e.products.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-3 hover:border-primary transition-colors",children:[(0,r.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-full h-24 rounded object-cover mb-2"}),(0,r.jsx)("p",{className:"text-sm font-medium truncate mb-1",children:e.name}),e.category&&(0,r.jsx)(u,{variant:"outline",className:"text-xs mb-2",children:e.category}),e.discount>0?(0,r.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,r.jsxs)("span",{className:"text-xs text-muted-foreground line-through",children:["$",e.price]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-primary",children:["$",(e.price*(1-e.discount/100)).toFixed(2)]}),(0,r.jsxs)(u,{variant:"destructive",className:"text-xs ml-auto",children:["-",e.discount,"%"]})]}):(0,r.jsxs)("p",{className:"text-sm font-bold text-primary mb-2",children:["$",e.price]}),(0,r.jsxs)(i.z,{size:"sm",className:"w-full text-xs",onClick:()=>as(e),children:[(0,r.jsx)(K.Z,{className:"h-3 w-3 mr-1"}),"Agregar a inventario"]})]},e.id))}),e.supplier&&(0,r.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,r.jsxs)("p",{children:["Contacto: ",e.supplier.email]})}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>{let s=null==y?void 0:y.users.find(s=>s.email===e.supplier.email);s&&(sj(s),sh(!0))},children:[(0,r.jsx)(M.Z,{className:"h-4 w-4 mr-2"}),"Contactar"]})]})]})]},e.id))})]}),(0,r.jsx)(j,{value:"billing",className:"p-4 space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(o.Zb,{children:[(0,r.jsx)(o.Ol,{children:(0,r.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(V.Z,{className:"h-5 w-5"}),"Nueva Venta"]})}),(0,r.jsxs)(o.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"customerName",children:"Cliente (opcional)"}),(0,r.jsx)(d.I,{id:"customerName",placeholder:"Nombre del cliente",value:sA,onChange:e=>sP(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{children:"Seleccionar Productos"}),(0,r.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-2",children:eZ.filter(e=>e.stock>0).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Stock: ",e.stock," | $",e.price,e.discount&&e.discount>0&&(0,r.jsxs)("span",{className:"text-green-600 ml-1",children:["(",e.discount,"% desc.)"]})]})]}),(0,r.jsx)(i.z,{size:"sm",onClick:()=>aa(e,1),disabled:0===e.stock,children:(0,r.jsx)(K.Z,{className:"h-3 w-3"})})]},e.id))})]}),sI.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{children:"Carrito de Venta"}),(0,r.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:sI.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:e.productName}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",e.unitPrice," x ",e.quantity," = $",e.subtotal.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>at(e.productId,e.quantity-1),children:(0,r.jsx)(el.Z,{className:"h-3 w-3"})}),(0,r.jsx)(d.I,{type:"number",min:"1",value:e.quantity,onChange:s=>{let a=parseInt(s.target.value)||1;at(e.productId,a)},className:"w-16 h-8 text-center text-sm mx-1"}),(0,r.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>at(e.productId,e.quantity+1),children:(0,r.jsx)(K.Z,{className:"h-3 w-3"})}),(0,r.jsx)(i.z,{size:"sm",variant:"destructive",onClick:()=>ar(e.productId),children:"\xd7"})]})]},"".concat(e.productId,"-").concat(e.quantity)))}),(0,r.jsxs)("div",{className:"border-t pt-2 space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:"Subtotal:"}),(0,r.jsxs)("span",{children:["$",an().subtotal.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm text-green-600",children:[(0,r.jsx)("span",{children:"Descuentos:"}),(0,r.jsxs)("span",{children:["-$",an().totalDiscount.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,r.jsx)("span",{children:"Total:"}),(0,r.jsxs)("span",{children:["$",an().total.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"saleNotes",children:"Notas (opcional)"}),(0,r.jsx)(D,{id:"saleNotes",placeholder:"Notas sobre la venta...",value:sZ,onChange:e=>sF(e.target.value)})]}),(0,r.jsxs)(i.z,{className:"w-full",onClick:()=>{if(0===sI.length){c.Am.error("El carrito est\xe1 vac\xedo");return}if(!m||"tendero"!==m.role){c.Am.error("Solo los tenderos pueden realizar ventas");return}for(let e of sI){let s=eZ.find(s=>s.id===e.productId);if(!s||s.stock<e.quantity){c.Am.error("Stock insuficiente para ".concat(e.productName));return}}let{subtotal:e,totalDiscount:s,total:a}=an(),r={id:crypto.randomUUID(),tenderoId:m.id,items:[...sI],subtotal:e,totalDiscount:s,total:a,createdAt:new Date().toISOString(),customerName:sA||void 0,notes:sZ||void 0},t=eZ.map(e=>{let s=sI.find(s=>s.productId===e.id);return s?{...e,stock:e.stock-s.quantity}:e}),l=[...sE,r];sO(l),eF(t),I((0,n.xq)(e=>({...e,products:t,sales:l}))),sB(e=>e+1),sV(r),sM(!0),sz([]),sP(""),sF(""),c.Am.success("✅ Venta completada por $".concat(a.toFixed(2)))},disabled:0===sI.length,children:[(0,r.jsx)(et.Z,{className:"h-4 w-4 mr-2"}),"Completar Venta"]})]})]})]}),(0,r.jsxs)(o.Zb,{children:[(0,r.jsx)(o.Ol,{children:(0,r.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(V.Z,{className:"h-5 w-5"}),"Historial de Ventas"]})}),(0,r.jsxs)(o.aY,{className:"space-y-4",children:[(0,r.jsxs)(Z,{value:sR,onValueChange:sq,children:[(0,r.jsx)(E,{children:(0,r.jsx)(F,{})}),(0,r.jsxs)(_,{children:[(0,r.jsx)(R,{value:"all",children:"Todas las ventas"}),(0,r.jsx)(R,{value:"today",children:"Hoy"}),(0,r.jsx)(R,{value:"week",children:"Esta semana"}),(0,r.jsx)(R,{value:"month",children:"Este mes"})]})]}),(0,r.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===ac().length?(0,r.jsx)("p",{className:"text-center text-muted-foreground py-4",children:"No hay ventas en este per\xedodo"}):ac().map(e=>(0,r.jsxs)("div",{className:"border rounded p-3 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.customerName||"Cliente an\xf3nimo"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleString("es-CO")})]}),(0,r.jsxs)("span",{className:"font-bold text-green-600",children:["$",e.total.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.items.length," productos",e.notes&&(0,r.jsxs)("span",{className:"ml-2",children:["• ",e.notes]})]}),(0,r.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>{sV(e),sM(!0)},children:"Ver Comprobante"})]},e.id))})]})]})]})})]})}),(0,r.jsx)(N,{open:se,onOpenChange:ss,children:(0,r.jsxs)(w,{className:"max-w-sm mx-auto max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:sa.barcode&&""!==sa.barcode?"Nuevo Producto (C\xf3digo Escaneado)":"Agregar Producto Manualmente"})}),sa.barcode&&(0,r.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-2",children:[(0,r.jsxs)("p",{className:"text-sm text-amber-800",children:["ℹ️ ",(0,r.jsx)("strong",{children:"C\xf3digo de barras no encontrado:"})," ",sa.barcode]}),(0,r.jsx)("p",{className:"text-xs text-amber-700 mt-1",children:"Completa los datos del producto y gu\xe1rdalo en el inventario"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-name",children:"Nombre del Producto *"}),(0,r.jsx)(d.I,{id:"product-name",value:sa.name,onChange:e=>sr({...sa,name:e.target.value}),placeholder:"Ej: Coca Cola 600ml"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-category",children:"Categor\xeda *"}),(0,r.jsxs)(Z,{value:sa.category,onValueChange:e=>sr({...sa,category:e}),children:[(0,r.jsx)(E,{id:"product-category",children:(0,r.jsx)(F,{placeholder:"Selecciona una categor\xeda"})}),(0,r.jsx)(_,{children:ec.map(e=>(0,r.jsx)(R,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-barcode",children:"C\xf3digo de Barras o C\xf3digo \xdanico *"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.I,{id:"product-barcode",value:sa.barcode,onChange:e=>sr({...sa,barcode:e.target.value}),placeholder:"Ej: 7501055363057 o PROD001",className:"flex-1"}),(0,r.jsx)(i.z,{type:"button",variant:"secondary",onClick:()=>sr({...sa,barcode:sY()}),title:"Generar c\xf3digo \xfanico",children:"✨"})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:sa.barcode?"C\xf3digo ingresado correctamente":"Presiona ✨ para generar un c\xf3digo \xfanico autom\xe1ticamente"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-stock",children:"Stock Actual *"}),(0,r.jsx)(d.I,{id:"product-stock",type:"number",min:"0",value:sa.stock,onChange:e=>sr({...sa,stock:Number.parseInt(e.target.value)||0}),placeholder:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-min-stock",children:"Stock M\xednimo *"}),(0,r.jsx)(d.I,{id:"product-min-stock",type:"number",min:"0",value:sa.minStock,onChange:e=>sr({...sa,minStock:Number.parseInt(e.target.value)||0}),placeholder:"5"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-price",children:"Precio (opcional)"}),(0,r.jsx)(d.I,{id:"product-price",type:"number",step:"0.01",min:"0",value:sa.price,onChange:e=>sr({...sa,price:Number.parseFloat(e.target.value)||0}),placeholder:"0.00"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"product-image",children:"Foto del Producto (opcional)"}),sa.image&&(0,r.jsxs)("div",{className:"mb-3 relative",children:[(0,r.jsx)("img",{src:sa.image,alt:"Preview",className:"w-full h-32 rounded-lg object-cover border"}),(0,r.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>sr(e=>({...e,image:""})),className:"absolute top-2 right-2",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>{var e;return null===(e=document.getElementById("product-image"))||void 0===e?void 0:e.click()},children:[(0,r.jsx)(X.Z,{className:"h-4 w-4 mr-2"}),"Cargar Foto"]}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",children:[(0,r.jsx)(ee.Z,{className:"h-4 w-4 mr-2"}),"Capturar"]})]}),(0,r.jsx)(d.I,{id:"product-image",type:"file",accept:"image/*",capture:"environment",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(a){if(a.size>5242880){sG("La imagen no puede ser mayor a 5MB","error");return}let e=new FileReader;e.onload=e=>{sr(s=>{var a;return{...s,image:null===(a=e.target)||void 0===a?void 0:a.result}})},e.readAsDataURL(a),sn(a)}},className:"hidden"})]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,r.jsxs)("p",{className:"text-xs text-blue-800",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Consejo:"})," Si escaneaste un c\xf3digo de barras que no se encontr\xf3, este ya estar\xe1 ingresado. Solo completa el nombre y dem\xe1s informaci\xf3n."]})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>{ss(!1),sr({name:"",barcode:"",category:"",stock:0,minStock:0,price:0,image:"",description:"",discount:0}),sn(null)},className:"flex-1",children:"Cancelar"}),(0,r.jsxs)(i.z,{onClick:()=>{if(!sa.name||!sa.barcode){c.Am.error("Por favor complete el nombre y el c\xf3digo de barras");return}if(!sa.category){c.Am.error("Por favor seleccione una categor\xeda");return}if(!sa.stock||!sa.minStock){c.Am.error("Por favor complete el stock actual y el stock m\xednimo");return}if(eZ.some(e=>e.barcode===sa.barcode)){c.Am.error("Ya existe un producto con este c\xf3digo de barras");return}if(sa.stock<0||sa.minStock<0){c.Am.error("Las cantidades no pueden ser negativas");return}let e={id:Date.now(),name:sa.name,barcode:sa.barcode,category:sa.category,stock:sa.stock,minStock:sa.minStock,price:sa.price||0,image:sa.image||"/placeholder.svg",description:sa.description||"",discount:sa.discount||0,ownerUserId:null==m?void 0:m.id,catalogType:"tendero"};eF(s=>{let a=[...s,e];return I((0,n.xq)(e=>({...e,products:a}))),a}),sr({name:"",barcode:"",category:"",stock:0,minStock:0,price:0,image:"",description:"",discount:0}),sn(null),ss(!1),c.Am.success("✅ ".concat(e.name," agregado correctamente al inventario"))},className:"flex-1",children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Agregar"]})]})]})]})}),(0,r.jsx)(N,{open:!!eI,onOpenChange:()=>ez(null),children:(0,r.jsxs)(w,{className:"max-w-sm mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Editar Producto"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"productName",children:"Nombre del Producto"}),(0,r.jsx)(d.I,{id:"productName",value:eA.name,onChange:e=>eP(s=>({...s,name:e.target.value})),placeholder:"Nombre del producto"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"productPrice",children:"Precio (opcional)"}),(0,r.jsx)(d.I,{id:"productPrice",type:"number",step:"0.01",min:"0",value:eA.price,onChange:e=>eP(s=>({...s,price:Number.parseFloat(e.target.value)})),placeholder:"0.00"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"minStock",children:"Stock M\xednimo"}),(0,r.jsx)(d.I,{id:"minStock",type:"number",min:"0",value:eA.minStock,onChange:e=>eP(s=>({...s,minStock:Number.parseInt(e.target.value)})),placeholder:"5"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recibir\xe1s alertas cuando el stock sea igual o menor a este valor"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>ez(null),className:"flex-1",children:"Cancelar"}),(0,r.jsxs)(i.z,{onClick:()=>{eF(e=>{let s=e.map(e=>e.id===eI.id?{...e,...eA}:e);return I((0,n.xq)(e=>({...e,products:s}))),s}),ez(null)},className:"flex-1",children:[(0,r.jsx)(P.Z,{className:"h-4 w-4 mr-2"}),"Guardar"]})]})]})]})}),(0,r.jsx)(N,{open:!!eR,onOpenChange:e=>!e&&eq(null),children:(0,r.jsxs)(w,{className:"max-w-sm mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{className:"text-center",children:null==eR?void 0:eR.name})}),eR&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("img",{src:eR.image||"/placeholder.svg",alt:eR.name,className:"w-full h-48 mx-auto rounded-lg object-cover border"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"C\xf3digo:"}),(0,r.jsx)("span",{className:"font-medium",children:eR.barcode})]}),eR.price>0&&(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Precio:"}),(0,r.jsxs)("span",{className:"font-medium text-primary",children:["$",eR.price.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Stock m\xednimo:"}),(0,r.jsxs)("span",{className:"font-medium",children:[eR.minStock," unidades"]})]})]}),(0,r.jsxs)("div",{className:"text-center py-4 bg-muted rounded-lg",children:[(0,r.jsx)("div",{className:"text-4xl font-bold mb-2",children:eR.stock}),(0,r.jsx)("div",{className:"text-lg font-medium ".concat(eR.stock<=eR.minStock?"text-amber-600":0===eR.stock?"text-red-600":"text-green-600"),children:0===eR.stock?"Sin Stock":eR.stock<=eR.minStock?"Stock Bajo":"Stock Disponible"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)(i.z,{variant:"outline",size:"lg",onClick:()=>sK(eR.id,-1),disabled:0===eR.stock,className:"h-12 w-12 rounded-full",children:(0,r.jsx)(el.Z,{className:"h-6 w-6"})}),(0,r.jsx)(i.z,{variant:"outline",size:"lg",onClick:()=>sK(eR.id,1),className:"h-12 w-12 rounded-full",children:(0,r.jsx)(K.Z,{className:"h-6 w-6"})})]}),eR.stock<=eR.minStock&&(0,r.jsxs)(i.z,{className:"w-full h-12 text-base",onClick:()=>{eq(null),eO("alerts")},children:[(0,r.jsx)(er.Z,{className:"h-4 w-4 mr-2"}),"Ver Ofertas de Proveedores"]}),(0,r.jsxs)(i.z,{variant:"destructive",className:"w-full",onClick:()=>{s4(eR.id),eq(null)},children:[(0,r.jsx)(Q.Z,{className:"h-4 w-4 mr-2"}),"Eliminar Producto"]})]})]})}),(0,r.jsx)(N,{open:sS,onOpenChange:sD,children:(0,r.jsxs)(w,{className:"max-w-sm mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Agregar producto al inventario"})}),sy&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("img",{src:sy.image||"/placeholder.svg",alt:sy.name,className:"w-24 h-24 rounded object-cover mx-auto mb-2"}),(0,r.jsx)("h3",{className:"font-medium",children:sy.name}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["$",sy.price]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S._,{htmlFor:"quantity",children:"Cantidad a agregar"}),(0,r.jsx)(d.I,{id:"quantity",type:"number",min:"1",value:sC,onChange:e=>sk(Number(e.target.value)),className:"mt-1"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{variant:"outline",className:"flex-1",onClick:()=>sD(!1),children:"Cancelar"}),(0,r.jsxs)(i.z,{className:"flex-1",onClick:()=>{sy&&sC>0&&(ae(sy,sC),sD(!1),sw(null),sk(1))},children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Agregar"]})]})]})]})}),(0,r.jsx)(N,{open:sT,onOpenChange:sM,children:(0,r.jsxs)(w,{className:"max-w-md mx-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(k,{children:"Comprobante de Venta"})}),sL&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center border-b pb-4",children:[(0,r.jsx)("h3",{className:"font-bold",children:(null==m?void 0:m.storeName)||"Mi Tienda"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(sL.createdAt).toLocaleString("es-CO")}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["ID: ",sL.id.slice(-8)]})]}),sL.customerName&&(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Cliente:"})," ",sL.customerName]})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Productos:"}),sL.items.map((e,s)=>(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium",children:e.productName}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["$",e.unitPrice," x ",e.quantity,e.discount>0&&(0,r.jsxs)("span",{className:"text-green-600 ml-1",children:["(-",e.discount,"%)"]})]})]}),(0,r.jsxs)("span",{children:["$",e.subtotal.toFixed(2)]})]},s))]}),(0,r.jsxs)("div",{className:"border-t pt-2 space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:"Subtotal:"}),(0,r.jsxs)("span",{children:["$",sL.subtotal.toFixed(2)]})]}),sL.totalDiscount>0&&(0,r.jsxs)("div",{className:"flex justify-between text-sm text-green-600",children:[(0,r.jsx)("span",{children:"Descuentos:"}),(0,r.jsxs)("span",{children:["-$",sL.totalDiscount.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t pt-1",children:[(0,r.jsx)("span",{children:"Total:"}),(0,r.jsxs)("span",{children:["$",sL.total.toFixed(2)]})]})]}),sL.notes&&(0,r.jsx)("div",{className:"border-t pt-2",children:(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Notas:"})," ",sL.notes]})}),(0,r.jsxs)("div",{className:"text-center text-xs text-muted-foreground border-t pt-2",children:[(0,r.jsx)("p",{children:"\xa1Gracias por su compra!"}),(0,r.jsx)("p",{children:"StockSync - Sistema de Inventario"})]}),(0,r.jsx)(i.z,{className:"w-full",onClick:()=>sM(!1),children:"Cerrar"})]})]})})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary/10 via-background to-primary/5 flex items-center justify-center p-4",children:(0,r.jsxs)(o.Zb,{className:"w-full max-w-md shadow-lg",children:[(0,r.jsxs)(o.Ol,{className:"text-center space-y-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-center gap-2 mb-2",children:(0,r.jsx)("div",{className:"bg-primary rounded-full p-3",children:(0,r.jsx)(q.Z,{className:"h-8 w-8 text-primary-foreground"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"StockSync"}),(0,r.jsx)(o.ll,{className:"text-xl",children:"Iniciar Sesi\xf3n"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ingresa tus credenciales para continuar"})]}),(0,r.jsx)(o.aY,{children:(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!z.trim()||!O.trim()){c.Am.error("Por favor complete todos los campos");return}let s=z.toLowerCase().trim(),a=null==y?void 0:y.users.find(e=>e.email.toLowerCase().trim()===s&&e.password===O);a?(x(a),localStorage.setItem("loggedInUser",JSON.stringify(a)),c.Am.success("Bienvenido de nuevo, ".concat(a.name))):c.Am.error("Credenciales incorrectas. Por favor intente de nuevo.")},className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"email",children:"Correo Electr\xf3nico"}),(0,r.jsx)(d.I,{id:"email",type:"email",value:z,onChange:e=>A(e.target.value),placeholder:"ejemplo@correo.com",required:!0,autoComplete:"email"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"password",children:"Contrase\xf1a"}),(0,r.jsx)(d.I,{id:"password",type:"password",value:O,onChange:e=>U(e.target.value),placeholder:"••••••••",required:!0,autoComplete:"current-password"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{children:"Tipo de Usuario"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)(i.z,{type:"button",variant:"tendero"===ei?"default":"outline",onClick:()=>eo("tendero"),className:"h-auto py-3 flex-col gap-1",children:[(0,r.jsx)(q.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:"Tendero"})]}),(0,r.jsxs)(i.z,{type:"button",variant:"proveedor"===ei?"default":"outline",onClick:()=>eo("proveedor"),className:"h-auto py-3 flex-col gap-1",children:[(0,r.jsx)(T.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:"Proveedor"})]})]})]}),(0,r.jsx)(i.z,{type:"submit",className:"w-full h-11",children:"Iniciar Sesi\xf3n"}),(0,r.jsx)("div",{className:"text-center text-sm text-muted-foreground mt-4",children:(0,r.jsx)("p",{children:"\xbfNo tienes cuenta? Contacta al administrador"})})]})})]})})}},2869:function(e,s,a){"use strict";a.d(s,{z:function(){return o}});var r=a(7437),t=a(2265),n=a(7053),l=a(535),c=a(4508);let i=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=t.forwardRef((e,s)=>{let{className:a,variant:t,size:l,asChild:o=!1,...d}=e,m=o?n.g7:"button";return(0,r.jsx)(m,{className:(0,c.cn)(i({variant:t,size:l,className:a})),ref:s,...d})});o.displayName="Button"},6070:function(e,s,a){"use strict";a.d(s,{Ol:function(){return c},Zb:function(){return l},aY:function(){return o},ll:function(){return i}});var r=a(7437),t=a(2265),n=a(4508);let l=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...t})});l.displayName="Card";let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...t})});c.displayName="CardHeader";let i=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...t})});i.displayName="CardTitle",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a),...t})}).displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",a),...t})});o.displayName="CardContent",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",a),...t})}).displayName="CardFooter"},5186:function(e,s,a){"use strict";a.d(s,{I:function(){return l}});var r=a(7437),t=a(2265),n=a(4508);let l=t.forwardRef((e,s)=>{let{className:a,type:t,...l}=e;return(0,r.jsx)("input",{type:t,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"},6815:function(e,s,a){"use strict";a.d(s,{_:function(){return o}});var r=a(7437),t=a(2265),n=a(6394),l=a(535),c=a(4508);let i=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(n.f,{ref:s,className:(0,c.cn)(i(),a),...t})});o.displayName=n.f.displayName},4508:function(e,s,a){"use strict";a.d(s,{cn:function(){return n},xq:function(){return m},y0:function(){return u},y1:function(){return o}});var r=a(1994),t=a(3335);function n(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,t.m6)((0,r.W)(s))}let l="stocksync:";function c(e,s){return function(e,s){if(!e)return s;try{return JSON.parse(e)}catch(e){return s}}(localStorage.getItem(l+e),s)}function i(e,s){localStorage.setItem(l+e,JSON.stringify(s))}function o(){return c("barcodeDb",{})}function d(){let e=c("state",{users:[],currentUserId:null,products:[],supplierProducts:[],announcements:[],supplierOffers:[],sales:[],purchases:[],chats:[]});if(0===e.users.length){let s={id:crypto.randomUUID(),name:"Admin",email:"admin@stocksync.local",password:"admin",role:"admin"},a={id:crypto.randomUUID(),name:"Samuel Tendero",email:"samuel@gmail.com",password:"1234",role:"tendero",phone:"+57 300 123 4567",storeName:"Tienda Samuel"},r={id:crypto.randomUUID(),name:"Samuel Proveedor",email:"samuel.proveedor@gmail.com",password:"1234",role:"proveedor",phone:"+57 300 765 4321",businessName:"Distribuidora Samuel S.A.",address:"Calle Principal #123, Cali",description:"Distribuidor mayorista de productos de consumo masivo"},t={...e,users:[s,a,r],currentUserId:null,supplierOffers:[],sales:[],purchases:[],chats:[]};return i("state",t),t}return e.chats||(e.chats=[]),e.supplierOffers||(e.supplierOffers=[]),e.sales||(e.sales=[]),e.purchases||(e.purchases=[]),(e.chats!=e.chats||e.supplierOffers!=e.supplierOffers||e.sales!=e.sales||e.purchases!=e.purchases)&&i("state",e),e}function m(e){let s=e(d());return i("state",s),s}function u(){return d()}}},function(e){e.O(0,[974,438,548,971,117,744],function(){return e(e.s=7130)}),_N_E=e.O()}]);